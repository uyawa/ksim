## Комп'ютерні системи імітаційного моделювання
## СПм-24-3, **Нальотов Дмитро Романович**
## Лабораторна робота №2. Редагування імітаційних моделей у середовищі NetLogo

### **Варіант 11**, модель у середовищі NetLogo:
[Autumn](https://www.netlogoweb.org/launch#https://www.netlogoweb.org/assets/modelslib/Sample%20Models/Biology/Autumn.nlogox)

## Внесені зміни у вихідну логіку моделі, за варіантом

Завданням передбачалося додати добові цикли зміни інтенсивності сонячного світла та температури.

1.  **Додано нові глобальні змінні** для відстеження стану добового циклу:
    * `day-duration`: Тривалість модельного "дня" у тіках (внутрішній параметр).
    * `current-sun-intensity`: Поточна, розрахована інтенсивність сонця.
    * `current-temperature`: Поточна, розрахована температура.
 
    ```nlogo
    globals [
      bottom-line
      evaporation-temp
      
      day-duration            ;; NEW
      current-sun-intensity   ;; NEW
      current-temperature     ;; NEW
      
      frost-temperature       ;; Зміна 
    ]
    ```

2.  **Оновлено процедуру `setup`** для ініціалізації нових змінних та першого виклику розрахунку циклу.

    ```nlogo
    to setup
      ; ... (інший код setup) ...
      set day-duration 240      ;; NEW: Встановлення тривалості дня
      set frost-temperature 0   ;; Зміна 
      ; ... (інший код setup) ...
      reset-ticks
      update-day-cycle ;; NEW: Встановлення початкових значень циклу
    end
    ```

3.  **Створено нову процедуру `update-day-cycle`**, яка розраховує поточні значення сонця та температури на основі `ticks` та `day-duration`, використовуючи синусоїдальну функцію для плавної зміни.

    ```nlogo
    to update-day-cycle
      let time-of-day (ticks mod day-duration)
      let angle (time-of-day / day-duration) * 360
      
      ;; day-factor змінюється від 0 (ніч) до 1 (південь) і назад до 0
      let day-factor ( (sin (angle - 90)) + 1 ) / 2 
      
      ;; Встановлюємо поточну інтенсивність сонця на основі макс. значення зі слайдера
      set current-sun-intensity (sun-intensity * day-factor)
      
      ;; Температура коливається +/- 5 градусів навколо базової (зі слайдера)
      let temp-swing (day-factor * 10) - 5 ;; Коливання від -5 (ніч) до +5 (день)
      set current-temperature (temperature + temp-swing)
    end
    ```

4.  **Оновлено процедуру `go`** для виклику `update-day-cycle` на кожному кроці моделювання.

    ```nlogo
    to go
      if not any? leaves [ stop ]
    
      update-day-cycle ;; NEW
    
      ; ... (решта коду go) ...
    end
    ```

5.  **Модифіковано процедури взаємодії агентів**, щоб вони використовували нові розраховані змінні (`current-sun-intensity` та `current-temperature`) замість значень зі слайдерів `sun-intensity` та `temperature`. Зміни внесено до:
    * `show-intensity`
    * `adjust-water`
    * `adjust-chlorophyll`
    * `adjust-sugar`
    * `change-color`

    *процедура `adjust-chlorophyll`:*
    ```nlogo
    to adjust-chlorophyll
      ;; Використання 'current-temperature' замість 'temperature'
      if current-temperature < 15 [
        set chlorophyll chlorophyll - (.5 * (15 - current-temperature))
      ]
      ;; Використання 'current-sun-intensity' замість 'sun-intensity'
      if current-sun-intensity > 75 [
        set chlorophyll chlorophyll - (.5 * (current-sun-intensity - 75))
      ]
      ;; Використання обох нових змінних
      if current-temperature > 15 and current-sun-intensity > 20 [
        set chlorophyll chlorophyll + 1
      ]
    end
    ```

## Внесені зміни у вихідну логіку моделі

На додаток до добових циклів, було додано механіку **"заморозків"**, яка активується, коли нічна температура падає нижче визначеного рівня.

1.  **Додано глобальну змінну `frost-temperature`** , яка визначає поріг для пошкодження листя. Вона ініціалізується у `setup`.

2.  **Створено нову процедуру `check-for-frost`**, яка виконується для кожного листка. Якщо температура падає нижче `frost-temperature`, листок отримує пошкодження, що прискорює його опадання (зменшує `attachedness`) та руйнує хлорофіл.

    ```nlogo
    to check-for-frost ;; leaf procedure
      if current-temperature < frost-temperature [
        ;; Пошкодження від морозу - листок стає крихким
        let damage-factor (frost-temperature - current-temperature)
        set attachedness attachedness - (damage-factor * 2) ;; Прискорене опадання
        set chlorophyll chlorophyll - (damage-factor * 0.5) ;; Руйнування хлорофілу
      ]
    end
    ```

3.  **Оновлено процедуру `go`** для виклику `check-for-frost` для кожного прикріпленого листка (`attached-leaves`) на кожному тіку.

    ```nlogo
    to go
      ; ... (код go) ...
    
      ;; Now our leaves respond accordingly
      ask attached-leaves [
        adjust-water
        adjust-chlorophyll
        adjust-sugar
        
        check-for-frost  ;; NEW 
        
        change-color
        change-shape
      ]
      
      ; ... (код go) ...
    end
    ```

## Обчислювальні експерименти: Дослідження впливу динамічних факторів

### Експеримент 1. Вплив добового циклу та заморозків на динаміку опадання листя

**Мета:** Проаналізувати, як інтегрований добовий цикл температури та механізм заморозків впливають на загальну швидкість опадання листя у моделі.

**Початкові умови (Спільні для всіх тестів):**
* `number-of-leaves`: 150
* `wind-factor`: 1
* `rain-intensity`: 10
* Тривалість симуляції: 1000 тіків

| Умова | Інтенсивність сонця | Середня температура | Тривалість добового циклу | Поріг температури заморозку | Тіки до опадання 50% листя | 
| :--- | :--- | :--- | :--- | :--- | :--- | 
| **1. Контроль (Статика)** | 50% | 10°C | Вимкнений | Немає | 900 |
| **2. Цикл (М'яка осінь)** | 100% | 12°C | 240 тіків | -5°C (неактивний) | 1250 | 
| **3. Цикл + Заморозки** | 100% | 3°C | 240 тіків | 0°C (активний) | 950 | 

**Інтенсивність сонця** - Верхня межа інтенсивності сонячного світла. Умова 1 (Статика) використовує це значення постійно. В умовах 2 та 3 (Цикл) це значення використовується як пікове під час "дня".

**Середня температура** - Значення з NetLogo. В умовах 2 та 3 фактична температура в моделі коливається навколо цього базового значення відповідно до добового циклу.

**Тривалість добового циклу** - Вказує, чи активний механізм добових коливань світла та температури (240 тіків = 1 цикл).

**Поріг температури заморозку** - Температура, нижче якої починає діяти механізм "заморозків" (тобто відбувається прискорене руйнування хлорофілу та зниження attachedness).

**Тіки до опадання 50% листя** - Кількість тіків,які необхідні для того, щоб половина початкової кількості листя (тобто 75 із 150) опала. Це прямий показник швидкості старіння та опадання.

Параметр **Немає** в умові **Поріг температури заморозку** вказує на те, що поріг заморозків не має сенсу для цієї умови, оскільки механізм заморозків не був активований і не міг впливати на симуляцію.

---
### Графік 1. Динаміка кількості листя у часі за різних погодних умов (1000 тіків)
<img width="990" height="631" alt="image" src="https://github.com/user-attachments/assets/2f8e5126-b22a-40e5-b9d1-96a425420f0d" />



**Опис графіку:**
Графік ілюструє, що швидкість опадання листя істотно залежить від наявності та параметрів добового циклу температури, особливо при введенні порога заморозків.

* **Контрольна група (Статика):** Спостерігається лінійне, відносно повільне опадання. Листя втрачає прихильність (attachedness) лише через постійний вітер та низьку ефективність фотосинтезу.
* **Цикл (М'яка осінь):** Опадання є найповільнішим. Динамічні зміни сонячного світла (денний пік) стимулюють короткочасне підвищення `attachedness` через інтенсивний фотосинтез, що частково компенсує нічне ослаблення.
* **Цикл + Заморозки:** Спостерігається **різке, нелінійне** опадання. Падіння відбувається стрибкоподібно (приблизно кожні 240 тіків, що відповідає нічному мінімуму температури). Під час нічних заморозків (коли `current-temperature < frost-temperature`) лінійка **`attachedness`** швидко знижується, що призводить до масового опадання на початку наступного "дня".

**Висновок експерименту:**

Експеримент підтверджує, що динаміка опадання листя залежить від комплексного впливу температури та освітлення, а не лише від одного чинника.

1.  **Найшвидша деградація (Умова 1: Контроль, 900 тіків):** Найменша кількість тіків для опадання 50% листя (900 тіків) була зафіксована у **Контрольній групі** зі статичними умовами (50% сонця, $10^\circ \text{C}$). Це свідчить про те, що **постійне підтримання помірно несприятливих умов**, без періодів інтенсивного фотосинтезу чи екстремальних заморозків, є найбільш ефективним чинником для стабільного і швидкого виснаження ресурсу листка.

2.  **Найповільніша деградація (Умова 2: Цикл, 1250 тіків):** Найповільніше опадання відбулося у сценарії **"М'яка осінь"** (1250 тіків). Хоча листя переживає нічне похолодання, високі пікові значення сонця ($100\%$) та середня температура ($12^\circ \text{C}$) забезпечують **найбільш ефективний фотосинтез** протягом дня. Це дозволяє листкам накопичувати цукор, що підвищує їхню прихильність (`attachedness`) та значно подовжує їхнє життя.

3.  **Вплив екстремального чинника (Умова 3: Заморозки, 950 тіків):** Сценарій із **регулярними нічними заморозками** ($0^\circ \text{C}$) призводить до опадання листя повільніше, ніж у Контролі (950 тіків). Це означає, що **заморозки, хоча й спричиняють масові стрибкоподібні падіння** (що добре видно на графіку), є менш деструктивним чинником у довгостроковій перспективі, ніж стабільна, помірна деградація. Це пояснюється тим, що низька середня температура ($3^\circ \text{C}$) сповільнює всі інші процеси втрати (наприклад, випаровування води) у денний час.

## **Загальний висновок:** 
Модель демонструє, що **динамічний цикл** дозволяє листю адаптуватися та протистояти опаданию завдяки періодам активного фотосинтезу (Умова 2). Найшвидший крах настає не від екстремального холоду, а від **стабільного, некомпенсованого виснаження ресурсів** (Умова 1).
