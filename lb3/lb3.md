## Комп'ютерні системи імітаційного моделювання
## СПм-24-3, **Нальотов Дмитро Романович**
### Лабораторна робота №**3**. Використання засобів обчислювального интелекту для оптимізації імітаційних моделей

<br>

### Варіант 11, модель у середовищі NetLogo:
[Autumn](https://www.netlogoweb.org/launch#http://www.netlogoweb.org/assets/modelslib/Sample%20Models/Biology/Autumn.nlogo)

</br>

#### Вербальний опис моделі:

Модель **Autumn** описує процес осінньої зміни листя на дереві під впливом зовнішніх умов. Листки мають запаси води та цукру, містять різні пігменти (хлорофіл, каротин, антоціанін) та параметр `attachedness`, що характеризує «міцність» кріплення листка до гілки.  

На кожному такті симуляції модель імітує:
- надходження води через дощ (`raindrops`) і кореневу систему;
- вплив температури та сонячного випромінювання на випаровування води та розклад хлорофілу;
- синтез цукру з води, хлорофілу і сонячного світла;
- перетворення цукру на червоний пігмент (антоціанін) за низьких температур;
- зменшення `attachedness` через вітер та нестачу води, що врешті приводить до падіння листя.

Кожен листок змінює свій колір залежно від співвідношення хлорофілу (зелений компонент), каротину (жовтий компонент) та антоціаніну (червоний компонент), що дозволяє візуально спостерігати перехід від «літнього» до «осіннього» дерева.

#### Керуючі параметри:

Основні керуючі параметри, доступні в інтерфейсі моделі Autumn (слайдери):

- **number-of-leaves** – кількість листків, що генеруються при виконанні `setup`. Впливає на густоту крони дерева та час виконання моделі.
- **start-sugar-mean** – середнє початкове значення рівня цукру в листках.
- **start-sugar-stddev** – стандартне відхилення початкового рівня цукру між листками.
- **temperature** – температура навколишнього середовища, від якої залежать:
  - швидкість випаровування води,
  - розклад хлорофілу,
  - перетворення цукру в антоціанін.
- **rain-intensity** – інтенсивність дощу (кількість нових крапель `raindrops` за такт), що впливає на надходження води до листків.
- **wind-factor** – сила вітру, яка:
  - зменшує `attachedness` листя,
  - задає горизонтальний зсув при падінні.
- **sun-intensity** – інтенсивність сонячного випромінювання, що впливає на:
  - синтез цукру,
  - розклад хлорофілу,
  - зовнішній вигляд «сонця» в моделі.
- **leaf-display-mode** – режим візуалізації листків (суцільні, за рівнем води, цукру, хлорофілу тощо). На логіку моделі не впливає, лише змінює відображення.

#### Показники роботи моделі:

У правій частині інтерфейсу моделі виводяться графіки:

- **Leaves**:
  - кількість живих листків (`leaves`);
  - кількість опалого листя (`dead-leaves`).
- **Weather conditions**:
  - температура (`temperature`);
  - інтенсивність дощу (`rain`);
  - сила вітру (`wind`);
  - інтенсивність сонця (`sunlight`).
- **Leaf averages**:
  - середній рівень `chlorophyll` (зелений пігмент);
  - середній рівень `water`;
  - середній рівень `sugar`;
  - середній рівень `carotene`;
  - середній рівень `anthocyanin`;
  - середній рівень `attachedness`.

Значення `attachedness` використовується для визначення, чи вважається листок ще прикріпленим до дерева. Для подальшої оптимізації важливим є показник **кількості листків, що залишилися прикріпленими** після певної кількості тактів.

<br>

### Налаштування середовища BehaviorSearch:

**Обрана модель**:
<pre>
C:\Program Files\NetLogo 7.0.2\models\Sample Models\Biology\Autumn.nlogo
</pre>

**Параметри моделі** (вкладка Model):  

Параметри та їх можливі діапазони були **автоматично завантажені** середовищем BehaviorSearch за допомогою кнопки  
«**Load parameter ranges from model interface**», після чого було вручну виправлено/звужено діапазони відповідно до завдання.  

У результаті специфікація параметрів набрала вигляду:

<pre>
["number-of-leaves" 200]
["start-sugar-mean" 50]
["start-sugar-stddev" 25]
["temperature"    [5 1 30]]
["rain-intensity" [0 1 20]]
["wind-factor"    [0.5 0.5 5]]
["sun-intensity"  [10 10 120]]
</pre>

Використовувана **міра (Measure)**:  

Метою є **максимізація кількості листків, що залишилися на дереві** після деякого часу симуляції. Для цього як показник роботи моделі було обрано:

<pre>
count attached-leaves
</pre>

Було задано тривалість одного прогону моделі **300 тактів**.  

У полі **Setup** зазначено процедуру ініціалізації `setup`, у полі **Step** — процедуру одного кроку `go`. Параметр **Measure if** приймає значення `true`, тобто показник обчислюється на кожному такті симуляції. У полі **Stop if** задається умова завершення моделювання:

<pre>
ticks >= 300
</pre>

Параметр **Step limit** також встановлено в 300, що відповідає максимальній кількості кроків для одного прогону моделі.


<img width="840" height="589" alt="image" src="https://github.com/user-attachments/assets/f08276b8-abfb-43a2-b828-4e3239ab6755" />


**Налаштування цільової функції** (вкладка Search Objective):  

Для задачі Autumn логічно максимізувати кількість листків, що залишилися прикріпленими після 300 тактів моделі. Тому в параметрі **Goal** вибрано значення **Maximize fitness**.

Оскільки нас цікавить саме **останнє** значення показника `count attached-leaves` на кроку 300, у полі **Collected measure** вибирається режим, який відповідає останньому значенню показника за кроками .  

Щоб зменшити вплив випадковості (використання `random` у моделі NetLogo), для кожної комбінації параметрів було виконано **по кілька повторів** (replications), а отримане значення fitness обчислювалося як **середнє** за всі повтори.

<img width="833" height="580" alt="image" src="https://github.com/user-attachments/assets/21622589-a79f-4411-adcf-0c9093711245" />


**Налаштування алгоритмів пошуку** (вкладка Search Algorithm):  

У ході дослідження використовувалися два алгоритми:

1. **Випадковий пошук (RandomSearch)**  
2. **Простий генетичний алгоритм (StandardGA)**

Для **RandomSearch** було задано:
- Algorithm: `RandomSearch`;
- Evaluation limit: **100** (кількість випадково згенерованих варіантів параметрів);
- Search Space Encoding Representation: значення за замовчуванням (*BinaryEncoding*);
- Use fitness caching: увімкнено для прискорення повторних обчислень.


Для **StandardGA**:
- Algorithm: `StandardGA`;
- Evaluation limit: **100** (загальна кількість оцінок рішень, розподілена між поколіннями);
- Population size: **25**;
- Імовірність кросовера та мутації залишені за замовчуванням BehaviorSearch (типові значення 0.7–0.9 та 0.1 відповідно);
- Search Space Encoding Representation: BinaryEncoding;
- Use fitness caching: увімкнено.

<img width="838" height="592" alt="image" src="https://github.com/user-attachments/assets/88bcafd8-97f8-4355-af22-d2b4e28a6639" />


<br>
### Результати використання BehaviorSearch:

Діалогове вікно запуску пошуку (Progress Dialog) показує хід роботи алгоритму: на графіку по осі X відкладається номер запуску (або покоління), по осі Y – значення fitness (кількість прикріплених листків).  

<img width="711" height="427" alt="image" src="https://github.com/user-attachments/assets/d877f80f-1c6a-430f-8857-51fb77307edb" />

Результат пошуку параметрів імітаційної моделі, використовуючи **генетичний алгоритм**:

<img width="839" height="591" alt="image" src="https://github.com/user-attachments/assets/13b7b964-85b8-4cbc-9b1c-a5c5a2262186" />


Результат пошуку параметрів імітаційної моделі, використовуючи **випадковий пошук**:

<img width="836" height="593" alt="image" src="https://github.com/user-attachments/assets/b888085a-6ece-48cf-8de3-02e95e0a2974" />


Після завершення пошуку BehaviorSearch формує таблицю найкращих знайдених комбінацій параметрів. Для кожного алгоритму було зафіксовано:

- **найкраще значення fitness** (максимальну кількість прикріплених листків);
- **відповідні значення параметрів** `temperature`, `rain-intensity`, `wind-factor`, `sun-intensity`.

Роботa імітаційної моделі (використовуючи NetLogo) при знайдених у BehaviorSearch значеннях параметрів **StandardGA**:
<img width="1067" height="852" alt="image" src="https://github.com/user-attachments/assets/7952aff3-80c2-4fde-becc-9389d6e0e0c2" />

Роботa імітаційної моделі (використовуючи NetLogo) при знайдених у BehaviorSearch значеннях параметрів **RandomSearch**:
<img width="1067" height="850" alt="image" src="https://github.com/user-attachments/assets/84e383cf-b948-4ded-a001-fceceefddd5a" />

На скріншоті де присутнs параметри, знайдені StandardGA видно, що навіть після тривалої симуляції значна частина листків залишається прикріпленою до дерева – крива leaves на графіку стабілізується на досить високому рівні. На скріншоті де параметри, знайдені RandomSearch більшість листків дуже швидко опадає, і крива leaves майже падає до нуля. Це підтверджує, що генетичний алгоритм підібрав параметри, які краще зберігають листя на дереві, ніж випадковий пошук.

### Висновки:


У ході виконання лабораторної роботи було проведено оптимізацію параметрів моделі _Autumn_ у середовищі BehaviorSearch з використанням двох методів пошуку: випадкового пошуку та простого генетичного алгоритму.

Результати показали, що:

1. **Генетичний алгоритм значно ефективніший**, оскільки він швидко наближається до кращих рішень і знаходить комбінації параметрів з максимальним fitness , що істотно перевищує найкраще значення випадкового пошуку.
    
2. Найбільший вплив на кількість листків, що залишилися прикріпленими, мають такі параметри:
    
    - **wind-factor** — чим менший вітер, тим довше листя тримається на дереві;
        
    - **temperature** — помірні значення сприяють збереженню води в листках;
        
    - **rain-intensity** — більша інтенсивність дощу зменшує ризик пересихання листя;
        
    - **sun-intensity** — надмірно сильне сонце пришвидшує розклад хлорофілу.
        
3. Оптимальні знайдені параметри мають фізичний сенс та відповідають очікуваній поведінці моделі: слабкий вітер, достатній рівень дощу і помірна температура забезпечують максимальну кількість листків, що залишаються прикріпленими до дерева.
  

